@page
@using TNTCalculatorRazor.Domain
@using TNTCalculatorRazor.Domain.Enums
@model IndexModel

<form method="post">

    <h3>基本情報</h3>

    <div>
        年齢: <input asp-for="Age" />
    </div>
    <div>
        身長(cm): <input asp-for="Height" />
    </div>
    <div>
        体重(kg): <input asp-for="Weight" />
    </div>
    <div>
        <label>
            <input type="radio" asp-for="Sex" value="Male" /> 男
        </label>
        <label>
            <input type="radio" asp-for="Sex" value="Female" /> 女
        </label>
    </div>

    <hr />

    <h3>活動・ストレス条件</h3>

    <div class="mb-3">
        <label class="form-label">活動係数</label>
        <select asp-for="ActivityFactor"
                class="form-select"
                asp-items="Html.GetEnumSelectList<ActivityFactorType>()">
        </select>
    </div>

    <div class="mb-3">
        <label class="form-label">基礎ストレス係数</label>
        <select asp-for="StressFactor"
                class="form-select"
                asp-items="Html.GetEnumSelectList<StressFactorType>()">
        </select>
    </div>

    <div class="mb-3">
        <label class="form-label">体温</label>
        <select asp-for="SelectedBodyTemperature"
                class="form-select"
                asp-items="Html.GetEnumSelectList<BodyTemperatureLevel>()">
        </select>
    </div>

    <hr />

    <h3>蛋白・水分条件</h3>

    <div>
        <label>
            <input type="radio"
                   asp-for="SelectedProteinCorrection"
                   value="None" />
            補正なし
        </label>
        <label>
            <input type="radio"
                   asp-for="SelectedProteinCorrection"
                   value="CKD3bTo5" />
            CKD3b–5（0.7）
        </label>
        <label>
            <input type="radio"
                   asp-for="SelectedProteinCorrection"
                   value="LiverCirrhosisPoor" />
            肝硬変蛋白不耐（0.5）
        </label>
    </div>

    <div>
        <label>
            <input type="checkbox" asp-for="IsHemodialysis" />
            血液透析（HD）
        </label>
    </div>

    <div>
        <label>
            <input type="checkbox" asp-for="IsPregnant" />
            妊娠
        </label>
    </div>

    <br />
    <button type="submit">計算</button>
</form>

<hr />

@if (Model.BmrResult != null)
{
    <p><strong>BMR</strong>：@Model.BmrResult.DisplayValue kcal/day</p>
    <p>使用式：@Model.BmrResult.Formula.ToDisplayName()</p>
}

@if (Model.BodyIndex != null)
{
    <p><strong>BMI</strong>：@Model.BodyIndex.Bmi.ToString("F1")</p>
    <p><strong>標準体重</strong>：@Model.BodyIndex.StandardWeight.ToString("F1") kg</p>

    @if (Model.BodyIndex.ObesityDegree != null)
    {
        <p>肥満度：@Model.BodyIndex.ObesityDegree.Value.ToString("F1") %</p>
    }
    else
    {
        <p>肥満度：算出対象外（0歳）</p>
    }
}

<p>
    <strong>体表面積</strong>：
    @Model.BodySurfaceArea.ToString("F3") m²
</p>

<p>
    <strong>推定必要カロリー</strong>：
    @Model.EnergyDisplay kcal/day
</p>

@if (Model.ProteinDisplayText != null)
{
    <p>
        <strong>必要蛋白質量</strong>：
        @Model.ProteinDisplayText g/day
    </p>
}

<p>
    <strong>必要水分量</strong>：
    @Model.WaterDisplay mL/day
</p>
@if (Model.WaterFeverCorrected)
{
    <p class="text-muted">
        ※ 発熱（@Model.SelectedBodyTemperature.ToDisplayName()）による水分補正を含みます
    </p>
}
<hr />

<h4>デバッグ表示</h4>

<pre>
BMR Raw = @Model.BmrResult?.RawValue
Activity(enum) = @Model.ActivityFactor
Activity(value) = @Model.ActivityFactorValue
Stress(enum) = @Model.StressFactor
Stress(base) = @Model.StressBase
Stress(temp) = @Model.StressTemperature
Stress(total) = @Model.StressTotal
Energy Raw = @Model.EnergyRaw
</pre>

<pre>
実測体重 = @Model.Weight
標準体重 = @Model.BodyIndex?.StandardWeight
補正体重 = @Model.AdjustedWeight
体重比 = @(Model.Weight == 0 ? "N/A" : (Model.AdjustedWeight / Model.Weight).ToString("F3"))
</pre>

<pre>
ProteinCondition = @Model.SelectedProteinCondition
ProteinCorrection = @Model.SelectedProteinCorrection
ProteinCorrect = @Model.ProteinCorrect
ProteinRaw = @Model.ProteinRaw
</pre>